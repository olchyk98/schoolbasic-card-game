{"ast":null,"code":"import rules from '../rules';\n\nfunction reducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var _ref = arguments.length > 1 ? arguments[1] : undefined,\n      type = _ref.type,\n      payload = _ref.payload;\n\n  var a = Object.assign({}, state);\n\n  switch (type) {\n    case 'INITIALIZE_GAME':\n      // WARNING: Store enter point\n      if (payload) {\n        var list = [];\n\n        for (var ma = rules.minCard; ma <= rules.maxCard; ma++) {\n          list.push(ma);\n        }\n\n        var gen = function gen() {\n          var b = [];\n\n          for (var _ma = 0; _ma < rules.userDeskSize; _ma++) {\n            b.push(list[Math.floor(Math.random() * list.length)]);\n          }\n\n          return b;\n        };\n\n        a = {\n          deskSize: rules.deskSize,\n          botDesk: gen(),\n          // [*]\n          playerDesk: gen(),\n          // [*]\n          inGame: true,\n          gameDesk: [],\n          currentTurn: \"USER_TURN\"\n        };\n      }\n\n      break;\n\n    case 'PUSH_CARD_TO_DESK':\n      {\n        var b = a.gameDesk,\n            c = {\n          value: payload.value,\n          sender: payload.sender\n        },\n            d = {\n          \"BOT_TARGET\": \"USER_TURN\",\n          \"USER_TARGET\": \"BOT_TURN\"\n        };\n\n        if (!b.slice(-1)[0] || b.slice(-1)[0].length !== 1) {\n          // create new\n          a.gameDesk.push([c]);\n        } else {\n          // beat\n          if (a.gameDesk[b.length - 1].slice(-1)[0].value < payload.value) {\n            a.gameDesk[b.length - 1].push(c);\n          }\n        }\n\n        a.playerDesk.splice(a.playerDesk.findIndex(function (io) {\n          return io === payload.value;\n        }), 1);\n        a.currentTurn = d[payload.sender];\n      }\n      break;\n\n    case 'START_BOT_RUNNER':\n      var START_BOT_RUNNER = function START_BOT_RUNNER() {\n        /* My first an - explained */\n        var b = a.botDesk,\n            // bot desc\n        d = a.gameDesk,\n            e = d.slice(-1)[0]; // last casted cart\n\n        if (!e || e.length !== 1) {\n          a.gameDesk.push([{\n            value: b[0],\n            sender: \"BOT_TARGET\"\n          }]);\n        } else {\n          var f = Infinity; // best answer\n\n          a.botDesk.forEach(function (io) {\n            if (io < f && io > e.slice(-1)[0].value) {\n              f = io;\n            }\n          });\n\n          if (isFinite(f)) {\n            // found\n            a.gameDesk[a.gameDesk.length - 1].push({\n              value: f,\n              sender: \"BOT_TARGET\"\n            });\n            a.botDesk.splice(a.botDesk.findIndex(function (io) {\n              return io === f;\n            }), 1);\n            START_BOT_RUNNER();\n          } else {\n            a.currentTurn = \"USER_TURN\";\n          }\n        }\n      };\n\n      START_BOT_RUNNER();\n      break;\n\n    case 'PASS_CURRENT_TURN':\n      if (a.currentTurn === 'USER_TURN') {\n        a.currentTurn = \"BOT_TURN\";\n        START_BOT_RUNNER();\n      }\n\n      break;\n\n    default:\n      break;\n  }\n\n  return a;\n}\n\nexport default reducer;","map":{"version":3,"sources":["/Users/olesodynets/Documents/Coding/htdocs/card-play/src/reducers/global.js"],"names":["rules","reducer","state","type","payload","a","Object","assign","list","ma","minCard","maxCard","push","gen","b","userDeskSize","Math","floor","random","length","deskSize","botDesk","playerDesk","inGame","gameDesk","currentTurn","c","value","sender","d","slice","splice","findIndex","io","START_BOT_RUNNER","e","f","Infinity","forEach","isFinite"],"mappings":"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","sourcesContent":["import rules from '../rules';\n\nfunction reducer(state = {}, { type, payload }) {\n    let a = Object.assign({}, state);\n\n    switch(type) {\n        case 'INITIALIZE_GAME': // WARNING: Store enter point\n            if(payload) {\n                let list = [];\n                for(let ma = rules.minCard; ma <= rules.maxCard; ma++) {\n                    list.push(ma);\n                }\n                let gen = () => {\n                    let b = [];\n                    for(let ma = 0; ma < rules.userDeskSize; ma++) {\n                        b.push(list[Math.floor(Math.random() * list.length)]);\n                    }\n\n                    return b;\n                }\n                \n                a = {\n                    deskSize: rules.deskSize,\n                    botDesk: gen(), // [*]\n                    playerDesk: gen(), // [*]\n                    inGame: true,\n                    gameDesk: [],\n                    currentTurn: \"USER_TURN\"\n                }\n            }\n        break;\n        case 'PUSH_CARD_TO_DESK':\n            {\n                let b = a.gameDesk,\n                    c = {\n                        value: payload.value,\n                        sender: payload.sender\n                    },\n                    d = {\n                        \"BOT_TARGET\" : \"USER_TURN\",\n                        \"USER_TARGET\" : \"BOT_TURN\"\n                    }\n                if(!b.slice(-1)[0] || b.slice(-1)[0].length !== 1) { // create new\n                    a.gameDesk.push([c]);\n                } else { // beat\n                    if(a.gameDesk[b.length - 1].slice(-1)[0].value < payload.value) {\n                        a.gameDesk[b.length - 1].push(c);\n                    }\n                }\n\n                a.playerDesk.splice(a.playerDesk.findIndex(io => io === payload.value), 1);\n                a.currentTurn = d[payload.sender];\n            }\n        break;\n        case 'START_BOT_RUNNER':\n            function START_BOT_RUNNER() {\n                /* My first an - explained */\n\n                let b = a.botDesk, // bot desc\n                    d = a.gameDesk,\n                    e = d.slice(-1)[0]; // last casted cart\n\n                if(!e || e.length !== 1) {\n                    a.gameDesk.push([{\n                        value: b[0],\n                        sender: \"BOT_TARGET\"\n                    }]);\n                } else {\n                    let f = Infinity; // best answer\n                    a.botDesk.forEach(io => {\n                        if(io < f && io > e.slice(-1)[0].value) {\n                            f = io;\n                        }\n                    });\n\n                    if(isFinite(f)) { // found\n                        a.gameDesk[a.gameDesk.length - 1].push({\n                            value: f,\n                            sender: \"BOT_TARGET\"\n                        });\n                        a.botDesk.splice(a.botDesk.findIndex(io => io === f), 1);\n                        START_BOT_RUNNER();\n                    } else {\n                        a.currentTurn = \"USER_TURN\";\n                    }\n                }\n            }\n\n            START_BOT_RUNNER();\n        break;\n        case 'PASS_CURRENT_TURN':\n            if(a.currentTurn === 'USER_TURN') {\n                a.currentTurn = \"BOT_TURN\";\n                START_BOT_RUNNER();\n            }\n        break;\n        default:break;\n    }\n\n    return a;\n}\n\nexport default reducer;"]},"metadata":{},"sourceType":"module"}