{"ast":null,"code":"import rules from '../rules';\n\nfunction reducer() {\n  var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var _ref = arguments.length > 1 ? arguments[1] : undefined,\n      type = _ref.type,\n      payload = _ref.payload;\n\n  var a = Object.assign({}, state);\n\n  function START_BOT_RUNNER() {\n    /* My first an - explained */\n    var b = a.botDesk,\n        // bot desc\n    d = a.gameDesk,\n        e = d.slice(-1)[0],\n        // last casted cart\n    g = function g(f) {\n      a.botDesk.splice(a.botDesk.findIndex(function (io) {\n        return io === f;\n      }), 1);\n    };\n\n    if (!e || e.length !== 1) {\n      a.gameDesk.push([{\n        value: b[0],\n        sender: \"BOT_TARGET\"\n      }]);\n      g(b[0]);\n      a.currentTurn = \"USER_TURN\";\n    } else {\n      var f = Infinity; // best answer\n\n      a.botDesk.forEach(function (io) {\n        if (io < f && io > e.slice(-1)[0].value) {\n          f = io;\n        }\n      });\n\n      if (isFinite(f)) {\n        // found\n        a.gameDesk[a.gameDesk.length - 1].push({\n          value: f,\n          sender: \"BOT_TARGET\"\n        });\n        g(f);\n        START_BOT_RUNNER();\n      } else {\n        // miss\n        a.isLoop = a.isLoop === null ? false : true;\n        a.currentTurn = \"USER_TURN\";\n      }\n    }\n  }\n\n  switch (type) {\n    case 'INITIALIZE_GAME':\n      // WARNING: Store enter point\n      if (payload) {\n        var list = [];\n\n        for (var ma = rules.minCard; ma <= rules.maxCard; ma++) {\n          list.push(ma);\n        }\n\n        var gen = function gen() {\n          var b = [];\n\n          for (var _ma = 0; _ma < rules.userDeskSize; _ma++) {\n            b.push(list[Math.floor(Math.random() * list.length)]);\n          }\n\n          return b;\n        };\n\n        a = {\n          deskSize: rules.deskSize,\n          botDesk: gen(),\n          // [*]\n          playerDesk: gen(),\n          // [*]\n          inGame: true,\n          gameDesk: [],\n          currentTurn: \"USER_TURN\",\n          isLoop: null\n        };\n      }\n\n      break;\n\n    case 'PUSH_CARD_TO_DESK':\n      {\n        var b = a.gameDesk,\n            c = {\n          value: payload.value,\n          sender: payload.sender\n        },\n            d = {\n          \"BOT_TARGET\": \"USER_TURN\",\n          \"USER_TARGET\": \"BOT_TURN\"\n        };\n\n        if (!b.slice(-1)[0] || b.slice(-1)[0].length !== 1) {\n          // create new\n          a.gameDesk.push([c]);\n        } else {\n          // beat\n          if (a.gameDesk[b.length - 1].slice(-1)[0].value < payload.value) {\n            a.gameDesk[b.length - 1].push(c);\n          }\n        }\n\n        a.playerDesk.splice(a.playerDesk.findIndex(function (io) {\n          return io === payload.value;\n        }), 1);\n        a.currentTurn = d[payload.sender];\n      }\n      break;\n\n    case 'START_BOT_RUNNER':\n      START_BOT_RUNNER();\n      break;\n\n    case 'PASS_CURRENT_TURN':\n      if (a.currentTurn === 'USER_TURN') {\n        a.isLoop = a.isLoop === null ? false : true;\n        a.currentTurn = \"BOT_TURN\";\n        START_BOT_RUNNER();\n      }\n\n      break;\n\n    default:\n      break;\n  }\n\n  return a;\n}\n\nexport default reducer;","map":{"version":3,"sources":["/Users/olesodynets/Documents/Coding/htdocs/card-play/src/reducers/global.js"],"names":["rules","reducer","state","type","payload","a","Object","assign","START_BOT_RUNNER","b","botDesk","d","gameDesk","e","slice","g","f","splice","findIndex","io","length","push","value","sender","currentTurn","Infinity","forEach","isFinite","isLoop","list","ma","minCard","maxCard","gen","userDeskSize","Math","floor","random","deskSize","playerDesk","inGame","c"],"mappings":"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","sourcesContent":["import rules from '../rules';\n\nfunction reducer(state = {}, { type, payload }) {\n    let a = Object.assign({}, state);\n\n    function START_BOT_RUNNER() {\n        /* My first an - explained */\n\n        let b = a.botDesk, // bot desc\n            d = a.gameDesk,\n            e = d.slice(-1)[0], // last casted cart\n            g = f => {\n                a.botDesk.splice(a.botDesk.findIndex(io => io === f), 1);\n            }\n\n        if(!e || e.length !== 1) {\n            a.gameDesk.push([{\n                value: b[0],\n                sender: \"BOT_TARGET\"\n            }]);\n            g(b[0]);\n            a.currentTurn = \"USER_TURN\";\n        } else {\n            let f = Infinity; // best answer\n            a.botDesk.forEach(io => {\n                if(io < f && io > e.slice(-1)[0].value) {\n                    f = io;\n                }\n            });\n\n            if(isFinite(f)) { // found\n                a.gameDesk[a.gameDesk.length - 1].push({\n                    value: f,\n                    sender: \"BOT_TARGET\"\n                });\n                g(f);\n                START_BOT_RUNNER();\n            } else { // miss\n                a.isLoop = (a.isLoop === null) ? false : true;\n                a.currentTurn = \"USER_TURN\";\n            }\n        }\n    }\n\n    switch(type) {\n        case 'INITIALIZE_GAME': // WARNING: Store enter point\n            if(payload) {\n                let list = [];\n                for(let ma = rules.minCard; ma <= rules.maxCard; ma++) {\n                    list.push(ma);\n                }\n                let gen = () => {\n                    let b = [];\n                    for(let ma = 0; ma < rules.userDeskSize; ma++) {\n                        b.push(list[Math.floor(Math.random() * list.length)]);\n                    }\n\n                    return b;\n                }\n                \n                a = {\n                    deskSize: rules.deskSize,\n                    botDesk: gen(), // [*]\n                    playerDesk: gen(), // [*]\n                    inGame: true,\n                    gameDesk: [],\n                    currentTurn: \"USER_TURN\",\n                    isLoop: null\n                }\n            }\n        break;\n        case 'PUSH_CARD_TO_DESK':\n            {\n                let b = a.gameDesk,\n                    c = {\n                        value: payload.value,\n                        sender: payload.sender\n                    },\n                    d = {\n                        \"BOT_TARGET\" : \"USER_TURN\",\n                        \"USER_TARGET\" : \"BOT_TURN\"\n                    }\n                if(!b.slice(-1)[0] || b.slice(-1)[0].length !== 1) { // create new\n                    a.gameDesk.push([c]);\n                } else { // beat\n                    if(a.gameDesk[b.length - 1].slice(-1)[0].value < payload.value) {\n                        a.gameDesk[b.length - 1].push(c);\n                    }\n                }\n\n                a.playerDesk.splice(a.playerDesk.findIndex(io => io === payload.value), 1);\n                a.currentTurn = d[payload.sender];\n            }\n        break;\n        case 'START_BOT_RUNNER':\n            START_BOT_RUNNER();\n        break;\n        case 'PASS_CURRENT_TURN':\n            if(a.currentTurn === 'USER_TURN') {\n                a.isLoop = (a.isLoop === null) ? false : true;\n                a.currentTurn = \"BOT_TURN\";\n                START_BOT_RUNNER();\n            }\n        break;\n        default:break;\n    }\n\n    return a;\n}\n\nexport default reducer;"]},"metadata":{},"sourceType":"module"}